# Проектная работа "Веб-ларек"
![main-screen.png](images/main-screen.png)

## Стек: TypeScript, Webpack

## Структура проекта:
* src/ — исходные файлы проекта
* src/components/ — папка с JS компонентами
* src/components/base/ — папка с базовым кодом

Важные файлы:
* src/pages/index.html — HTML-файл главной страницы
* src/types/index.ts — файл с типами
* src/index.ts — точка входа приложения
* src/scss/styles.scss — корневой файл стилей
* src/utils/constants.ts — файл с константами
* src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды
```bash
yarn
yarn start
```
## Сборка
```bash
yarn build
```

## Архитектура проекта
Архитектура проекта на основе паттерна MVP (Model-View-Presenter) состоит из трех основных частей:

* Model (Модель) - отвечает за хранение данных и бизнес-логику приложения. Модель представляет собой набор классов, которые описывают сущности приложения (например, товары, корзина, заказы и т.д.) и предоставляют методы для работы с ними. Модель не зависит от представления и может быть использована в других частях приложения.
* View (Представление) - отвечает за отображение пользовательского интерфейса и взаимодействие с пользователем. Представление представляет собой набор классов, которые описывают элементы интерфейса (например, окна, формы, кнопки и т.д.) и предоставляют методы для их отображения и обработки событий от пользователя. Представление не содержит логики приложения и не должно обращаться напрямую к модели.
* Presenter (Презентер) - содержит бизнес-логику приложения и связывает модель и представление. Презентер представляет собой набор классов, которые обрабатывают события от представления, извлекают данные из модели, обрабатывают их и передают в представление для отображения. Презентер является посредником между моделью и представлением и обеспечивает их взаимодействие.
* Event Broker (Брокер событий) - обеспечивает обмен сообщениями между компонентами приложения. Брокер событий представляет собой набор классов, которые позволяют компонентам подписываться на события и отправлять сообщения другим компонентам. Брокер событий позволяет избежать жесткой связи между компонентами и упрощает взаимодействие между ними.

Принцип работы MVP с брокером событий следующий:

* Пользователь взаимодействует с представлением (нажимает кнопки, вводит данные и т.д.).
* Представление генерирует события и отправляет их в брокер событий.
* Брокер событий передает события в презентер, который подписан на эти события.
* Презентер обрабатывает события, вызывает методы модели для изменения данных и подписывается на события об изменении данных.
* Модель изменяет данные и генерирует события об изменении данных.
* Брокер событий передает события об изменении данных в презентер.
* Презентер обрабатывает события об изменении данных и вызывает методы представления для обновления отображения данных.
* Представление отображает данные и ждет новых событий от пользователя.

Таким образом, паттерн MVP с брокером событий позволяет разделить логику приложения и представление, а также обеспечить гибкое и удобное взаимодействие между компонентами приложения.

## Базовые классы

### 1. Класс Component
Класс Component - это базовый класс для всех представлений в приложении. Он предоставляет базовый функционал для работы с DOM-элементами и обработки событий.

Конструктор класса Component принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)

Содержит следующие методы:
* render - отвечает за отображение представления
* remove - удаляет представление из DOM
* show - отображает представление
* hide - скрывает представление


### 2. Класс EventEmitter
Класс EventEmitter отвечает за обмен событиями между компонентами. Конструктор класса EventEmitter не принимает параметров.

Содержит следующие методы:
* on: Устанавливает обработчик на событие.
* off: Снимает обработчик с события.
* emit: Инициирует событие с данными.
* onAll: Подписывается на все события.
* offAll: Сбрасывает все обработчики.
* trigger: Возвращает функцию-триггер, генерирующую событие при вызове.

События, которые будет обрабатывать класс EventEmitter:
* product-add-to-basket - генерируется при добавлении товара в корзину
* product-remove-from-basket - генерируется при удалении товара из корзины
* order-send - генерируется при отправке заказа на сервер
* form-validate - генерируется при валидации формы
* form-data-get - генерируется при получении данных из формы.


### 3. Класс Api
Класс Api базовый класс для работы с API

Содержит следующие методы:
* handleResponse: Обработчик ответа от сервера
* get: Метод для выполнения GET-запроса
* post: Метод для выполнения POST-запроса


## Классы представления

### 4. Класс Page
Класс Page наследуется от класса Component и отвечает за отображение страницы. Конструктор класса Page принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)

Содержит следующие методы:
* render - отвечает за отображение страницы


### 5. Класс Card
Класс Card наследуется от класса Component и отвечает за отображение карточки товара. Конструктор класса Card принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* type - тип отображаемой карточки
* id - номер продукты
* description - описание
* image - картинка
* title - заголовок
* category - категория
* price - цена

Содержит следующие методы:
* render - отвечает за отображение карточки товара


### 6. Класс Modal
Класс Modal наследуется от класса Component и отвечает за отображение модального окна. Конструктор класса Modal принимает следующие параметры:

* contentElement - поле класса для хранения элемента разметки для отображения контента
* closeButtonElement - поле класса для хранения и возможности настройки взаимодействия с кнопкой закрытия.

Содержит следующие методы:
* render - отвечает за отображение модального окна
* open - открывает модальное окно
* close - закрывает модальное окно


### 7. Класс Basket
Класс Basket наследуется от класса Component и отвечает за отображение корзины. Конструктор класса Basket принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* items - Список продуктов в корзине

Содержит следующие методы:
* render - отвечает за отображение корзины


### 8. Класс Form
Класс Form наследуется от класса Component и отвечает за отображение формы. Конструктор класса Form принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)

Содержит следующие методы:
* render - отвечает за отображение формы


### 9. Класс Order
Класс Order наследуется от класса Component и отвечает за отображение формы оформления заказа. Конструктор класса Order принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* payments - содержимое поля email (тип: String)
* address - содержимое поля email (тип: String)

Содержит следующие методы:
* render - отвечает за отображение формы оформления заказа


### 10. Класс Contacts
Класс Contacts наследуется от класса Component и отвечает за отображение контактной информации. Конструктор класса Contacts принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* phone - содержимое поля email (тип: String)
* email - содержимое поля email (тип: String)

Содержит следующие методы:
* render - отвечает за отображение контактной информации


### 11. Класс Success
Класс Success наследуется от класса Component и отвечает за отображение сообщения об успешном выполнении операции. Конструктор класса Success принимает следующие параметры:

* contentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)

Содержит следующие методы:
* render - отвечает за отображение сообщения

## Классы моделей

### 12. Класс AppData
Класс AppData отвечает за работу с данными приложения. Конструктор класса AppData принимает следующие параметры:

* catalog: Product[];
* cart - содержание корзины
* order - поля для заказа
* selectedItem - текущий выбранный продукт
* openedModal - тип открытого модального окна, перечислены в AppModals
* isLoading - значение для отображения загрузки данных по APi
* isError - значение если загрузка вернула ошибку

Содержит следующие методы:
* getProducts - возвращает список товаров
* addProductToBasket - добавляет товар в корзину
* removeProductFromBasket - удаляет товар из корзины
* validateAddress - валидирует форму адреса
* validateContacts - валидирует форму контактов
* order - возвращает данные для заказа


## Вспомогательные классы

### 13. Класс LarekApi
Класс LarekApi наследуется от класса Api и добавляет специфические методы для работы магазина

Содержит следующие методы:
* getProducts(): Promise<Product[]> - получение списка товаров с сервера
* sendOrder(formData: FormData): Promise<ApiResponse> - отправка заказа на сервер


## Базовые типы
'''typescript
interface Product {
id: string;
description: string;
image: string;
title: string;
category: string;
price: number;
}

interface Cart {
items: Product[];
}

interface Payments {
payment: string;
address: string;
}

interface Contacts {
email: string;
phone: string;
}

interface Order extends Payments, Contacts {}

// Ключи для активации модельного окна
export enum AppModals {
item = 'modalitem',
cart = 'modalcart',
orderPayment = 'modalorderpayment',
orderAddress = 'modalordersuccess',
orderSuccess = 'modalordersuccess',
}

interface AppState {
catalog: Product[];
cart: Cart;
order: Order;
selectedItem?: string;
openedModal: AppModals;
isLoading: boolean;
isError: boolean;
}

interface ILarekApi {
getProducts(): Promise<Product[]  | ResponseError>;
sendOrder(order: Order): Promise<OrderResult | ResponseError>;
}

'''