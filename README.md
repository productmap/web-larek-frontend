# Проектная работа "Веб-ларек"
![main-screen.png](images/main-screen.png)

## Стек: TypeScript, Webpack

## Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды
```bash
yarn
yarn start
```
## Сборка
```bash
yarn build
```

## Архитектура проекта
Архитектура проекта на основе паттерна MVP (Model-View-Presenter) состоит из трех основных частей:

- Model (Модель) - отвечает за хранение данных и бизнес-логику приложения. Модель представляет собой набор классов, которые описывают сущности приложения (например, товары, корзина, заказы и т.д.) и предоставляют методы для работы с ними. Модель не зависит от представления и может быть использована в других частях приложения.
- View (Представление) - отвечает за отображение пользовательского интерфейса и взаимодействие с пользователем. Представление представляет собой набор классов, которые описывают элементы интерфейса (например, окна, формы, кнопки и т.д.) и предоставляют методы для их отображения и обработки событий от пользователя. Представление не содержит логики приложения и не должно обращаться напрямую к модели.
- Presenter (Презентер) - содержит бизнес-логику приложения и связывает модель и представление. Презентер представляет собой набор классов, которые обрабатывают события от представления, извлекают данные из модели, обрабатывают их и передают в представление для отображения. Презентер является посредником между моделью и представлением и обеспечивает их взаимодействие.
- Event Broker (Брокер событий) - обеспечивает обмен сообщениями между компонентами приложения. Брокер событий представляет собой набор классов, которые позволяют компонентам подписываться на события и отправлять сообщения другим компонентам. Брокер событий позволяет избежать жесткой связи между компонентами и упрощает взаимодействие между ними.

Принцип работы MVP с брокером событий следующий:

- Пользователь взаимодействует с представлением (нажимает кнопки, вводит данные и т.д.).
- Представление генерирует события и отправляет их в брокер событий.
- Брокер событий передает события в презентер, который подписан на эти события.
- Презентер обрабатывает события, извлекает данные из модели, обрабатывает их и отправляет сообщения в брокер событий.
- Брокер событий передает сообщения в представление, которое подписано на эти сообщения.
- Представление отображает данные и ждет новых событий от пользователя.

Таким образом, паттерн MVP с брокером событий позволяет разделить логику приложения и представление, а также обеспечить гибкое и удобное взаимодействие между компонентами приложения.

## Базовые классы

### 1. Класс Component

Конструктор класса Component принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)

Класс Component содержит следующие методы:
* render - отвечает за отображение представления
* remove - удаляет представление из DOM
* show - отображает представление
* hide - скрывает представление

### 2. Класс Modal

Класс Modal наследуется от класса Component и отвечает за отображение модального окна. Конструктор класса Modal принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения модального окна (тип: Object)

Класс Modal содержит следующие методы:
* render - отвечает за отображение модального окна
* close - закрывает модальное окно

### 3. Класс Basket

Класс Basket наследуется от класса Component и отвечает за отображение корзины. Конструктор класса Basket принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения корзины (тип: Object)

Класс Basket содержит следующие методы:
* render - отвечает за отображение корзины
* addProduct - добавляет товар в корзину
* removeProduct - удаляет товар из корзины

### 4. Класс Form

Класс Form наследуется от класса Component и отвечает за отображение формы. Конструктор класса Form принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения формы (тип: Object)

Класс Form содержит следующие методы:
* render - отвечает за отображение формы
* validate - валидирует форму
* getData - возвращает данные, введенные в форму

### 5. Класс Success

Класс Success наследуется от класса Component и отвечает за отображение сообщения об успешном выполнении операции. Конструктор класса Success принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения сообщения (тип: Object)

Класс Success содержит следующие методы:
* render - отвечает за отображение сообщения

### 6. Класс Page

Класс Page наследуется от класса Component и отвечает за отображение страницы. Конструктор класса Page принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения страницы (тип: Object)

Класс Page содержит следующие методы:
* render - отвечает за отображение страницы

### 7. Класс Card

Класс Card наследуется от класса Component и отвечает за отображение карточки товара. Конструктор класса Card принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения карточки товара (тип: Object)

Класс Card содержит следующие методы:
* render - отвечает за отображение карточки товара

### 8. Класс Order

Класс Order наследуется от класса Component и отвечает за отображение формы оформления заказа. Конструктор класса Order принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения формы оформления заказа (тип: Object)

Класс Order содержит следующие методы:
* render - отвечает за отображение формы оформления заказа
* validate - валидирует форму оформления заказа
* getData - возвращает данные, введенные в форму оформления заказа

### 9. Класс Contacts

Класс Contacts наследуется от класса Component и отвечает за отображение контактной информации. Конструктор класса Contacts принимает следующие параметры:

* parentElement - элемент DOM, в котором будет размещено представление (тип: HTMLElement)
* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)
* data - данные, необходимые для отображения контактной информации (тип: Object)

Класс Contacts содержит следующие методы:
* render - отвечает за отображение контактной информации

### 10. Класс AppData

Класс AppData отвечает за работу с данными приложения. Конструктор класса AppData принимает следующие параметры:

* eventEmitter - экземпляр класса EventEmitter, отвечающий за обмен событиями между компонентами (тип: EventEmitter)

Класс AppData содержит следующие методы:
* getProducts - возвращает список товаров
* getProduct - возвращает данные конкретного товара
* addProductToBasket - добавляет товар в корзину
* removeProductFromBasket - удаляет товар из корзины
* sendOrder - отправляет заказ на сервер

### 11. Класс EventEmitter

Класс EventEmitter отвечает за обмен событиями между компонентами. Конструктор класса EventEmitter не принимает параметров.

Класс EventEmitter содержит следующие методы:
* on: Устанавливает обработчик на событие.
* off: Снимает обработчик с события.
* emit: Инициирует событие с данными.
* onAll: Подписывается на все события.
* offAll: Сбрасывает все обработчики.
* trigger: Возвращает функцию-триггер, генерирующую событие при вызове.

События, которые будет обрабатывать класс EventEmitter:
* product-add-to-basket - генерируется при добавлении товара в корзину
* product-remove-from-basket - генерируется при удалении товара из корзины
* order-send - генерируется при отправке заказа на сервер
* form-validate - генерируется при валидации формы
* form-data-get - генерируется при получении данных из формы.


### 12. Класс Api
Класс Api базовый класс для работы с API

Класс Api содержит следующие методы:
* handleResponse: Обработчик ответа от сервера
* get: Метод для выполнения GET-запроса
* post: Метод для выполнения POST-запроса

### 13. Класс LarekApi
Класс LarekApi наследуется от класса Api и добавляет специфические методы для работы магазина

Класс LarekApi будет содержать следующие методы:
* getProducts(): Promise<Product[]> - получение списка товаров с сервера
* sendOrder(formData: FormData): Promise<ApiResponse> - отправка заказа на сервер


## Базовые типы
'''typescript
export interface Product {
id: string;
description: string;
image: string;
title: string;
category: string;
price: number;
}

export interface Cart {
items: Product[];
total: number; // total price of products
}

interface Payments {
payment: string;
address: string;
}

interface Contacts {
email: string;
phone: string;
}

export interface Order extends Payments, Contacts {}

export enum AppModals {
item = 'modalitem',
cart = 'modalcart',
orderPayment = 'modalorderpayment',
orderAddress = 'modalordersuccess',
orderSuccess = 'modalordersuccess',
}

export interface AppState {
catalog: Product[];
cart: Cart;
order: Order;
selectedItem?: string;
openedModal: AppModals;
isLoading: boolean;
isError: boolean;
}

export interface ILarekApi {
getProducts(): Promise<Product[]  | ResponseError>;
sendOrder(order: Order): Promise<OrderResult | ResponseError>;
}

'''